FROM ubuntu:22.04

RUN apt update

RUN apt install git make curl unzip android-sdk sdkmanager -y

RUN sdkmanager --install "platforms;android-33" && sdkmanager --install "build-tools;30.0.3"

RUN mv /opt/android-sdk/platforms/android-33 /usr/lib/android-sdk/platforms/

RUN mv /opt/android-sdk/build-tools/30.0.3 /usr/lib/android-sdk/build-tools/

RUN mkdir /usr/lib/android-sdk/cmdline-tools/

RUN cp -r /usr/lib/android-sdk/tools/ /usr/lib/android-sdk/cmdline-tools/latest

RUN cp /usr/bin/sdkmanager /usr/lib/android-sdk/cmdline-tools/latest/bin/

RUN git clone --depth 1 --branch 3.13.3 https://github.com/flutter/flutter.git /usr/local/flutter

ENV PATH="/usr/local/flutter/bin:/usr/local/flutter/bin/cache/dart-sdk/bin:${PATH}"

RUN flutter doctor

ENV ANDROID_HOME=/usr/lib/android-sdk

ENV PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools

RUN yes | sdkmanager --licenses

RUN yes | flutter doctor --android-licenses